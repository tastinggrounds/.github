name: create-release
description: Tag and create a release in GitHub
runs:
  using: 'composite'
  steps:
    - name: PWD
      shell: bash
      run: |
        if test -f "package.json"; then
          VERSION=v$(cat package.json | jq .version -r)
        elif test -f "VERSION"; then
          VERSION=v$(cat VERSION)
        else
          echo "No package.json or VERSION file found"
          exit 1
        fi

        gh --version

        EXIT_CODE=0	

        git tag ${VERSION} || EXIT_CODE=$?	

        if [ $EXIT_CODE -ne 0 ];	
        then	
          echo "Skip taging $VERSION because it already exists."	
          exit 0
        else	
          git push origin $VERSION	
          echo "Tagged $VERSION"	
        fi
        
        echo "Creating GitHub Release: $VERSION"
    